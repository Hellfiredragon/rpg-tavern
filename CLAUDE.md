# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

RPG Tavern is an LLM-powered RPG engine. Players connect, describe what their characters want to do, and the server uses LLMs to alter world state and narrate the story. Data is stored as files on disk.

## Tech Stack

- **Backend:** Python 3.12+ with FastAPI, managed by **uv**
- **Frontend:** React 19 + TypeScript with Vite, managed by **bun**
- Backend serves the built frontend as static files from `backend/static/`

## Commands

### Development

```bash
uv run main.py          # Start backend + frontend in watch mode (main dev workflow)
```

### Backend only

```bash
uv run uvicorn backend.app:app --reload --port 13013   # Start backend with hot-reload
uv add <package>                                        # Add a Python dependency
```

### Frontend only

```bash
cd frontend && bun run dev       # Vite dev server (proxies /api → backend)
cd frontend && bun run build     # Build to backend/static/
cd frontend && bun run lint      # ESLint
```

## Architecture

```
backend/              Python backend (FastAPI)
  app.py              App factory, mounts routes + static files
  routes.py           API endpoints under /api
  static/             Built frontend assets (gitignored, generated by `bun run build`)
  data/               File-based data storage

frontend/             React + TypeScript (Vite)
  src/                React source code
  vite.config.ts      Build output → ../backend/static, dev proxy /api → backend

.env.example          Default config (copy to .env to override)
```

### Configuration (.env)

All ports/host are configured via `.env` at the project root (see `.env.example`). Vite reads it via `loadEnv()`, Python via `python-dotenv`. Key vars: `HOST`, `BACKEND_PORT`, `FRONTEND_PORT`.

### Dev proxy setup

In development, the Vite dev server proxies `/api/*` requests to the backend. In production, the backend serves everything — API routes and static frontend files — from a single port.

## Workflow

- After completing a piece of work, provide a commit message the user can use
- **Commit messages** use semantic prefixes: `feat(topic):`, `fix(topic):`, `chore(topic):`, `refactor(topic):`, `test(topic):`, `docs(topic):`
- Keep TODOS.md updated when completing items listed there
